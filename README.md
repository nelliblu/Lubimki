# Lubimki 

#### Подготовили Беклемышева Олеся, Блуменау Нелли, Сапрыкина Анастасия 

#### Доступные файлы:
* song_normalize.csv - база данных
* eda-lubimki.ipynb - файл с EDA и визуализациями
* ml-lubimki.ipynb - файл с машинным обучением
#### Структура проекта: 
#### Шаг 1. Сбор данных
Набор выбранных данных содержит аудиостатистику 2000 лучших треков на Spotify с 2000 по 2019 год (https://www.kaggle.com/datasets/paradisejoy/top-hits-spotify-from-20002019). Он включает 18 столбцов, каждый из которых описывает конкретный трек и его звуковые качества: 
*  **artist** - имя исполнителя 
*  **song** - название песни
*  **duration_ms** - продолжительность песни в миллисекундах
*  **explicit** - содержание мата в тексте песен (True - содержатся, False - нет)
*  **year** -  год выпуска трека
*  **popularity** - популярность песни (чем выше значение, тем популярнее песня)
*  **danceability** - переменная, которая показывает, насколько песня подходит для танцев (0 - наименее подходит, 1 - наиболее подходит)
*  **energy** - мера интенсивности и активности песни (0 - наименее интенсивная, 1 - наиболее интенсивная)
*  **key** - закодированная переменная тональности песни (например, 0 = C, 1 = C♯/D♭, 2 = D и т.д. Если ключ не был обнаружен, значение равно -1)
*  **loudness** -   уровень громкости песни в децибелах (дБ)
*  **mode** - модальность (мажор - 1, минор - 0)
*  **speechiness** - разборчивость, наличие произносимых слов в песне (наиболее разборчиво - 1; наименее разборчиво - 0) 
*  **acousticness** -  показатель для определения того, является ли песня акустической (наиболее акустическая - 1, наименее акустическая - 0)
*  **instrumentals** - доля инстументала в песне 
*  **liveness** - доля присутствия бэк-вокала в песне
*  **valence** - мера музыкальной позитивности песни (самая непозитивная - 0, самая позитивная - 1)
*  **tempo** - темп песни в битах в минуту  
*  **genre** - жанр песни
  
#### Шаг 2. Предобработка данных
Выбранный датасет не содержит пустых строк, что является преимуществом, поскольку нам не нужно обращаться к методам обработки пропущенных значений.
#### Шаг 3. Визуализация данных 
Были построены классические графики: топ самых популярных артистов, число хитов и средняя продолжительность треков в динамике, а также распределение популярности песен, популярность песен по годам, топ жанров, а также взаимосвязь нескольких переменных с популярностью.
#### Шаг 4. Создание новых признаков
Наш проект включает в себя рассмотрение таких факторов, как энергия  (energy), темпа (tempo), громкости (loudness). Данные элементы можно объединить в один признак - оценка драйва (drive) трека, что оказывает большое влияние на восприятие песни аудиторией и его положение в топе Spotify.
Для создания нового признака мы совершим следующие шаги:
1. Для начала мы стандартизируем показатели энергии (energy), темпа (tempo) и громкости (loudness), что позволит нам получить наилучший результат. 
2. Для рассчета драйва (drive) мы применяем метод PCA для создания нового признака.
#### Шаг 5. Проверка гипотез
При работе над проектом у нашей команды появились следующие гипотезы, которые мы будем проверять: 
* **Популярность песен с минорным ладом в среднем больше, чем популярность песен с мажорным.** \
  Сейчас мы распишем способ, которым планируем проверить нашу гипотезу. Формулируем нулевую и альтернативную гипотезу. Н(0): средняя популярность песен в минорном ладу (u(min)) равна средней популярности песен в мажорном ладу (u(maj)). H(a): средняя популярность песен в минорном ладу (u(min)) больше, чем средняя популярность песен в мажорном ладу (u(maj)). Далее делим песни на две группы: минорный лад и мажорный лад. Затем проверяем размер выборки. Скорее всего, так как у нас 2000 песен, размер выборки будет достаточно большим, чтобы применить Центральную Предельную Теорему (необходимо для t-теста). После уже проводим односторонний t-тест для независимых выборок, затем проверяем, значимо ли различие между средним значением популярности двух групп. Если alternative='greater', то => среднее значение по минору больше, нежели по мажору.
* **Между уровнем громкости и мерой, которая показывает, насколько песня подходит для танцев есть положительная зависимость.** 
* **Между длительностью песни и популярностью есть отрицательная зависимость.** \
  Проверка 2 и 3 гипотезы будет по одному алгоритму. Опять же необходимо сформулировать нулевую и альтернативную гипотезу. Для третей гипотезы: Н(0): Нет зависимости между длительностью песни и популярностью (р = 0, коэффициент корреляции = 0). Н(а): Между длительностью песни и популярностью есть отрицательная корреляция (р < 0). Вычисляем наблюдаемый коэффициент корреляции р(obs) с помощью столов duration и popularity. Далее проводим перестановочный тест для статистической значимости наблюдаемой корреляции. После определяем критическое значение корреляции р(crit). Для уровня 5% найдем критическое значение. По итогу сравним наблюдаемое и критическое значение, если выполяется условие р(obs) < p(crit) для отклонения нулевой гипотезы в сторону альтернативной. На основе этого мы и получим либо подтверждение, либо опровержение гипотезы 2 и 3.
#### Шаг 6. Машинное обучение
Для данной задачи мы можем попробовать предсказать переменную popularity (популярность песни). Это количественная метрика, показывающая, насколько популярна песня, и может варьироваться в зависимости от различных факторов, таких как жанр, танцевальность, энергичность и другие аудиохарактеристики. Для измерения качества модели мы будем использовать метрику RMSE (Root Mean Squared Error). Эта метрика позволяет нам понять среднее значение ошибок предсказания, выраженное в тех же единицах, что и предсказанные значения. Линейная регрессия показала лучшие результаты среди рассмотренных моделей, Случайный лес и Градиентный бустинг показали худшие результаты с более высоким значением MSE и отрицательными значениями R². Тесты показали, что зависимость от целевой переменной слабо предсказывается с помощью данных моделей, из чего можно сделать вывод, что значения popularity (популярность песен) нельзя в полной мере объяснить в зависимости от доступных переменных.

